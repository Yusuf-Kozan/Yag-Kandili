@page "/ana"
@layout AnaTaslak
@using System.Threading.Tasks
@using Esas
@using Kilnevüg
@using Bileşenler
@inject IJSRuntime JSruntime
@inject NavigationManager NavigationManager
@namespace sayfa


    @if (oturum_açık)
    {

        <div class="ana-beden">
            @*<h1>@a</h1>
            <h1>@b</h1>
            <h2>@DateTime.Now.ToString("ddMMyyyyHHmmss")</h2>
            <h2>@oturum_açık.ToString()</h2>*@
            <TümPaylaşımlar kim="@üye" oturum="@kimlik"/>
        </div>
        <EnHerŞey aÜye="@üye" aKimlik="@kimlik" aKonum="/ana"/>
        <!--<h1 class="Yükleniyor">Yükleniyor</h1>-->
    }
    else
    {
        <h1 class="Yükleniyor">Yükleniyor</h1>
    }



@code {
    private string a, b; //a == kullanıcı adı && b == kilmik
    private bool oturum_açık;
    public static ÜyeBil üye {get; set;}
    public static string kimlik {get; private set;}
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        try
        {
            var c = await JSruntime.InvokeAsync<string>("Çerezİşleri.ÇerezOku", "kullanıcı");
            a = c.ToString(); c = null;
            var d = await JSruntime.InvokeAsync<string>("Çerezİşleri.ÇerezOku", "oturum");
            b = d.ToString(); d = null;
            devam(a, b);
            StateHasChanged();
        }
        catch
        {
            NavigationManager.NavigateTo("/");
        }
    }
    private void devam(string kullanıcı_kimliği, string oturum_kimliği)
    {
        oturum_açık = Esas.VeriTabanı.Oturum.BuOturumAçık(oturum_kimliği, kullanıcı_kimliği);
        if (!oturum_açık)
        {
            NavigationManager.NavigateTo("/");
        }
        üye = Esas.VeriTabanı.Üyelik.ÜyeBilgileri(kullanıcı_kimliği);
        Ana.kimlik = oturum_kimliği;
    }
}