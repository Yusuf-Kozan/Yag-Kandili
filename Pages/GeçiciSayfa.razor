@page "/g/{bağlantı_değişkeni}"
@*"geçici" anlamında 'g'*@
@layout GeçiciSayfaDüzeni
@using Bileşenler
@using Bileşenler.GeçiciSayfa
@using Esas.VeriTabanı
@inject NavigationManager NavigationManager

@if (bağlantı.İÇERİK_TÜRÜ == "kişisel veri")
{
    string belge_adı = $"{bağlantı.HEDEF_KULLANICI}-" +
                $"{bağlantı.BAŞLANGIÇ_TARİHİ.ToString("yyyyMMddHHmmss")}" +
                "-KV.zip";
    <ÖzelBelgeİndir hedef_kullanıcı=@(bağlantı.HEDEF_KULLANICI)
            sağlanacak_belge=@(bağlantı.SAĞLANACAK_BELGE)
            belge_adı=@(belge_adı)
            belge_türü="application/zip" />
}

@code {
    [Parameter]
    public string bağlantı_değişkeni {get; set;}

    private Esas.GeçiciBağlantı.GeçiciBağlantı bağlantı;

    protected override void OnParametersSet()
    {
        bool bağlantı_kullanımda = GeçiciBağlantı.BuBağlantıKullanımda(bağlantı_değişkeni);
        if (!bağlantı_kullanımda)
        {
            NavigationManager.NavigateTo("/ana");
        }
        else if (GeçiciBağlantı.BağlantıSüresiDurumu(bağlantı_değişkeni) != 0)
        {
            NavigationManager.NavigateTo("/ana");
        }
        else
        {
            bağlantı = GeçiciBağlantı.BağlantıBilgisi(bağlantı_değişkeni);
        }
    }
}